			var before = $("#prev");
			var after = $("#next");
			var t = $("#text");
			var v = $("#video");
			var w = $(".well");
			
			var slid = 0;
			function update(change) {
				if (change != 0) {
					slid += change;
				}
				if (slid < 0) {
					slid = 0;
				} else if (slid >= data.length) {
					slid = data.length - 1;
				}
				before.attr("disabled", slid == 0);
				if (slid == data.length - 1) {
					after.text("END");
					after.css("background-color", "red");
					// module
				} else {
					after.text("NEXT");
					after.css("background-color", "");
					if (change == 0) {
						refresh();
					} else {
						var firstAnim = (change < 0 ? "Right" : "Left");
						var secondAnim = (change < 0 ? "Left" : "Right");
						
						w.addClass("animated fadeOut" + firstAnim + "Big").one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
							refresh();
							$(this).removeClass("fadeOut" + firstAnim + "Big")
									.addClass("animated fadeIn" + secondAnim + "Big")
									.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
								$(this).removeClass("animated fadeIn" + secondAnim + "Big");
							});
						});
					}
				}
			}
			
			function refresh() {
						var b = data[slid];
						if (b.mode == 0) {
							t.css("display", "block");
							v.css("display", "none");
							t.text(b.content);
							after.attr("disabled", false);
						} else if (b.mode == 1) {
							t.css("display", "none");
							v.css("display", "block");
							v.attr("src", b.content);
							after.attr("disabled", false);
						} else if (b.mode == 2) {
							t.css("display", "none");
							v.css("display", "none");
							after.attr("disabled", true);
							// TODO
						}
			}
			
			function next() {
				if (after.attr("disabled")) {
					return;
				}
				update(1);
				
				var b = data[slid];
				var chang = (b.mode + 1);
				$.post("/change", {type: typ, slide: slid, change: chang}, function(data) {
					if (data == 'error') {
						alert("An error occurred.");
					} else if (data != 'none') {
						var pDisplay = $('.points');
					
						var oldPoints = parseInt(pDisplay.text());
						var newPoints = parseInt(data);
						
						var difference = newPoints - oldPoints;
						
						$('.pointchange').text('+' + difference).removeClass("fadeOutUpBig").addClass("animated fadeInUpBig")
									.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
							$(this).removeClass("fadeInUpBig")
									.addClass("animated fadeOutUpBig");
						});
						
						pDisplay.text('' + data);
					}
				});
			}
			
			function prev() {
				if (before.attr("disabled")) {
					return;
				}
				update(-1);
			}
			
			$(document).ready(function() {
				update(0);
			});